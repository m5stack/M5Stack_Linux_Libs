# M5Stack_Linux_Libs

`M5Stack_Linux_Libs` A open-source and lightweight Linux C/C++ application development framework that offers an extensive library and programming examples, serving as a minimal dependency framework. It supports compiling C/C++ projects for both native and embedded platforms within the Unix environment.

## Project Directory Overview


``` bash
M5Stack_Linux_Libs/
├── components # The component library root directory is an essential component of the project, offering the flexibility to selectively compile the library into the project. This approach aims to achieve minimal dependencies and reduce the executable file size.
    ├── component1  # Component library template, which allows for rapid addition of the component library following this template.
    ├── hv          # libhv Component
    ├── lvgl_component  # lvgl_component Component
    └── DeviceDriver   # DeviceDriver Component
        ├── include # include directory
        ├── party
            ├── framebuffer # linux framebuffer Simple library
            ├── linux_i2c   # linux i2c Simple library
            ├── linux_spi   # linux spi Simple library
            ├── linux_uart  # linux uart Simple library
            ├── ptmx        # linux pts Virtual terminal library
    ...
├── doc
├── examples    # The source code repository for the project.
│   ├── demo1   # A project template that can be duplicated to quickly set up a development project.
    ...
├── github_source # github Location for Source Code
│   ├── source-list.sh # GitHub source code repository index, files need to be manually downloaded to this directory. Except for the "source-list.sh" file, other files will not be included in the repository's version history.
│   ├── libhv   # libhv source
└── tools   # Directory for Storing Scripts and Tools
    ├── cmake   # cmake Compilation Script Directory
    ├── config_defaults_cross.mk    # Cross-platform Default Configuration, Primarily Used for Cross-Compiling SDK Setup.
    ├── kconfig # Python Kconfig Library Source Code
    ├── Makefile.mk # Implementation of Common Make Operations.
```

Start compiling a "Hello, World!" program as our beginning.  
Framework relies on the following software packages: make, cmake, python3, and expect. Please ensure that the aforementioned packages are installed.
``` bash
# Assuming your current terminal is in the "dianjixz-lib" directory.
# Install Dependencies (Only Needs to be Done Once)
sudo apt update
sudo apt install make cmake python3 expect

# Navigate to the "examples/demo1" directory.
cd examples/demo1

# Start the compilation. Sometimes, compilation failures might occur. You can use `make distclean` to thoroughly clean the project's build files.
make

# After executing the `make` command, the project will complete compilation. The generated executable file and related dependency libraries will be copied to the "dist" directory. You can choose to run `make` to execute it or run it manually.
make run  
# cd dist;./demo1   # Run it manually.

# Clean up compilation files.
make clean

# Thoroughly clean compilation files, including the compilation options generated by `make menuconfig`.
make distclean
```

## Features

<!-- - Platform reuse（Linux, Windows, macOS） -->
- Integrate multiple C/C++ software libraries such as libhv, stb, CImg, and more, which enable you to quickly utilize these libraries.
- Comes with usage examples for various libraries, sparing you the effort of searching, downloading, installing, and then seeking out the usage methods for libraries online. Simple libraries provide code and documentation, while complex ones offer direct usage examples.
- Examples of TCP/UDP server/client and more.
- Reliable UDP support: Example with KCP.
- WebSocket server/client examples.
- MQTT client example.
- C/C++ Hybrid Development.
- Fast cross-compilation. Use the command `make set_arm` to switch the cross-compiler and enjoy seamless cross-compilation.
- Minimal dependencies. Automatic packaging of dependencies for framework components within, with the option for dynamic and static dependencies. Say goodbye to the complexities of dependencies.
- Configuration for minimal executable size. Enabling the "release" compilation mode generates the smallest executable file size possible.


## More examples

In the project's "examples" directory, there are numerous examples including multi-threading, multi-thread synchronization locks, daemon processes, dynamic library invocation, Linux hardware bus development, LVGL GUI, U8g2 driver for SH1107, and many more. You can readily copy code from other repositories and add it to your own project as needed.

## Compile native program
``` bash
# Enter the working directory
cd examples/demo1
# Compile
make
# Test run the program
make run
```

## Cross-compile the program
``` bash
# Enter the working directory
cd examples/demo1
# Edit the Makefile file, and set the values of CROSS_DIR and CROSS.
make set_arm

# Compile
make
# Edit the Makefile file, and set the values of HOST_IP, PUSH_DIR, SSH_USER, and SSH_PASSWORD. 
make push
# Run the program using the ssh command.
# make push_run
```
## More commands
``` bash
# Clean up compilation files.
make clean
# Thoroughly clean compilation files.
make distclean
# Compile optimized version of the program (may result in runtime anomalies).
make release
# Output detailed compilation process.
make verbose
# Enable or disable built-in libraries.
make menuconfig
```

## More Info

Please review the documentation files located in the 'doc' directory.
- ["Detailed description of this framework."](../assets/README.md)